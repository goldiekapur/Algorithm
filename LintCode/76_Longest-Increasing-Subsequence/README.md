Typical DP solution. 
Without optimization, time complexity O(n^2).
With optimization, time complexity (O(nlogn)).