Typical 01 backpack problem.
The solution is to use the one-dimension optimization.

Note that the k loop should be reversed: i.e., from big to small.